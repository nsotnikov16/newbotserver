## Краткое описание работы сервера
Сервер работает на библиотеке express

Принимает 2 запроса:
* GET - служит для проверки работоспособности бота (при необходимости можно отключить)
* POST - основные входящие запросы с которыми происходит работа (сюда запросы приходят с другого бэкенда)

При клике на кнопку в чате или при отправке сообщения пользователем посылается запрос на основной бэкенд, в котором происходит обработка сессий и прочих параметров. Далее запрос переходит СЮДА, где происходит работа со сценариями ботов (у пользователя их может быть несколько). Отработав сценарии ботов, формируются данные для запроса на другой бэкенд. Оттуда уже результат приходит пользователю.

Запуск приложения происходит в файле **newserver.js**

В роутинге (POST /) происходит работа процессинга бота (lib/Processing) и логирование запросов

Описание свойств тела POST запроса, с которым предстоит работать:
| Свойство | Тип |  Описание |
| -------- | ---- |  --------- |
| bots | Array | Массив ботов с которыми взаимодействовал пользователь |
| bots[].bot_id | string | Идентификатор сценария |
| bots[].session_id | string | Идентификатор сессии пользователя |
| message | string | Сообщение пользователя или ID кнопки на которую нажал пользователь |
| type_do | string | Тип сущности (button/message/delay) |
| sec | number | Количество секунд для приходящей задержки (delay) с крона |

Обработка данных и отправка пользователю:
1. Получаем информацию по сценариям и сессиям
2. Фильтруем данные на крайний вопрос (сценарий, на котором остановился пользователь, когда бот задал ему вопрос) или отсутствующую историю (на точке старта, когда соответствует условию)
3. Запускаем обработку полученных сценариев
4. В каждом сценарии формируются данные для отправки
5. Данные для отправки модифицируются с учётом задержек в сценарии
6. Отправка данных пользователю (точнее на другой бэкенд)